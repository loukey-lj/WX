<mxfile host="app.diagrams.net" modified="2022-07-25T08:34:33.230Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36" etag="V3dzzF1kKEvzp_1dYeqv" version="20.1.3" type="github" pages="2">
  <diagram id="alpazB9rDXZP1vT-j2JS" name="CDC-HUDI">
    <mxGraphModel dx="1662" dy="1931" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-2" value="目标&lt;br&gt;&amp;nbsp; &amp;nbsp; 1、建表&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1.1、给直通车提供生成建表的工具类，在直通车生成建表语句，之后直通车调用资产进行建表&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1.2、建表的时候需要加上注释信息&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 1.3、mor 表去掉 ro/rt 并且兼容 原生 ro/rt 方式&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; 2、表变更信息同步 hive&lt;br&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;2.1、cdc hudi&amp;nbsp; commit 时做变更检测&amp;nbsp;schama，分区变更调用资产接口进行同步（资产调用失败如何处理）&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;3、hive 存量同步&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;3.1、hive 存量 和 mysql 全量的去重&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;4、cdc hudi&lt;br&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;4.1、mysql 数据清理和正常业务清理进行区分&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;4.2、版本的清理&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; 5、hive hudi 化&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;5.1、增量视图/无感切换&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;6、schema on read&lt;br&gt;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;6.1、可以对字段进行增删， schema 版本的保存&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="10" y="-1160" width="700" height="330" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-4" target="rjfQ9kvNoMq7JbhmC_GC-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-4" value="Actor" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" parent="1" vertex="1">
          <mxGeometry x="22.5" y="-700" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-9" target="rjfQ9kvNoMq7JbhmC_GC-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-9" value="CDC 接入" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;" parent="1" vertex="1">
          <mxGeometry x="126.5" y="-700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-20" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=25;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-11" target="rjfQ9kvNoMq7JbhmC_GC-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-177" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-11" target="rjfQ9kvNoMq7JbhmC_GC-176" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-11" value="审批通过" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="306.5" y="-700" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-21" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.014;exitY=0.583;exitDx=0;exitDy=0;exitPerimeter=0;entryX=1.029;entryY=0.367;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-14" target="rjfQ9kvNoMq7JbhmC_GC-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-14" value="建表工具" style="shape=cube;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;darkOpacity=0.05;darkOpacity2=0.1;size=10;" parent="1" vertex="1">
          <mxGeometry x="436.5" y="-760" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-236" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-15" target="rjfQ9kvNoMq7JbhmC_GC-235" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-237" value="建表/元数据同步" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-236" vertex="1" connectable="0">
          <mxGeometry x="-0.1444" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-15" value="资产" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="616.5" y="-700" width="83.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-18" value="" style="endArrow=classic;html=1;rounded=0;curved=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-11" target="rjfQ9kvNoMq7JbhmC_GC-15" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="446.5" y="-670" as="sourcePoint" />
            <mxPoint x="496.5" y="-720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-19" value="调用资产建表" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-18" vertex="1" connectable="0">
          <mxGeometry x="0.175" y="4" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-25" value="需要加上注释&lt;br&gt;mor 表去掉 ro/rt" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="530" y="-750" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-40" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-33" target="rjfQ9kvNoMq7JbhmC_GC-44" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="381.5" y="-555.8275862068965" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-33" value="数据归档" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="224" y="-812.5" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-36" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;dashed=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-9" target="rjfQ9kvNoMq7JbhmC_GC-33" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="186.5" y="-670" as="sourcePoint" />
            <mxPoint x="224" y="-762.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-37" value="mysql 归档周期设置&lt;br&gt;按照分区去归档" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-36" vertex="1" connectable="0">
          <mxGeometry x="0.2794" relative="1" as="geometry">
            <mxPoint x="11" y="5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-44" value="HUDI 只处理在归档周期内的 binlog 事件&lt;br&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;非分区表没有归档周期 binlog 事件都需要处理&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;解决 4.1&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" parent="1" vertex="1">
          <mxGeometry x="388" y="-825" width="250" height="65" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-231" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-73" target="rjfQ9kvNoMq7JbhmC_GC-212" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="490" y="-350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-233" value="获取调度运行状态" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-231" vertex="1" connectable="0">
          <mxGeometry x="-0.1287" y="1" relative="1" as="geometry">
            <mxPoint x="-127" y="23" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-248" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-73" target="rjfQ9kvNoMq7JbhmC_GC-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-73" value="&lt;span style=&quot;&quot;&gt;直通车check调度任务状态&lt;/span&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="38" y="-270.5" width="87.5" height="87.5" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=13;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-77" target="rjfQ9kvNoMq7JbhmC_GC-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-249" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-77" target="rjfQ9kvNoMq7JbhmC_GC-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-250" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-77" target="rjfQ9kvNoMq7JbhmC_GC-78" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-77" value="调度运行状态" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="165.5" y="-272.5" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-78" value="运行中" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="292" y="-200.75" width="70" height="35.75" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-252" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-80" target="rjfQ9kvNoMq7JbhmC_GC-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-80" value="失败" style="text;html=1;strokeColor=#B20000;fillColor=#e51400;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontColor=#ffffff;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="293.5" y="-246.5" width="68.5" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-251" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-82" target="rjfQ9kvNoMq7JbhmC_GC-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-82" value="成功" style="text;html=1;strokeColor=#005700;fillColor=#008a00;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontColor=#ffffff;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="294.5" y="-290" width="68.5" height="37" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-83" value="告警处理" style="rounded=1;whiteSpace=wrap;html=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="409.5" y="-243.5" width="80" height="33.5" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-86" value="" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=30;notch=30;" parent="1" vertex="1">
          <mxGeometry x="67" y="-275" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-87" value="" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0;dx=30;notch=30;rotation=-180;" parent="1" vertex="1">
          <mxGeometry x="77" y="-189" width="10" height="10" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-239" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.938;entryY=0.983;entryDx=0;entryDy=0;entryPerimeter=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-137" target="rjfQ9kvNoMq7JbhmC_GC-195" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="730" y="-402" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-240" value="启动CDC" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-239" vertex="1" connectable="0">
          <mxGeometry x="-0.12" y="2" relative="1" as="geometry">
            <mxPoint x="-17" y="18" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-137" value="所有调度都成功" style="rounded=1;whiteSpace=wrap;html=1;fontSize=13;" parent="1" vertex="1">
          <mxGeometry x="412.75" y="-291" width="76.75" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-145" value="1、对于同步 hive 的先生成一个调度任务,如果需要分配执行的就生成多个调度任务，直通车记录调度 id&lt;br&gt;&lt;br&gt;2、直通车定期去扫未完成的调度状态，当所有的调度都完成时则更新接入状态，并重启 cdc 程序，cdc 发现主动发现新增表&lt;br&gt;&lt;br&gt;3、对于调度失败的任务, 需要人工处理，将调度重试成功" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="510" y="-290" width="310" height="136" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-161" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-25" target="rjfQ9kvNoMq7JbhmC_GC-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-179" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;entryX=0.925;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-176" target="rjfQ9kvNoMq7JbhmC_GC-203" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="172" y="-576" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-180" value="Y" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-179" vertex="1" connectable="0">
          <mxGeometry x="-0.25" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-194" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-176" target="rjfQ9kvNoMq7JbhmC_GC-195" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="435" y="-575" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-197" value="&amp;nbsp;N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-194" vertex="1" connectable="0">
          <mxGeometry x="0.5273" y="1" relative="1" as="geometry">
            <mxPoint x="-96" y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-229" value="启动 CDC" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-194" vertex="1" connectable="0">
          <mxGeometry x="0.4292" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-176" value="是否hive&lt;br&gt;存量同步" style="rhombus;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="300" y="-615" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-241" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-195" target="rjfQ9kvNoMq7JbhmC_GC-238" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-195" value="实时计算" style="rounded=1;whiteSpace=wrap;html=1;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="616.5" y="-605" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-199" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;entryX=0.45;entryY=0.033;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;edgeStyle=orthogonalEdgeStyle;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-203" target="rjfQ9kvNoMq7JbhmC_GC-205" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="110" y="-318" as="sourcePoint" />
            <mxPoint x="128.5" y="-228" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-200" value="&lt;span style=&quot;background-color: rgb(248, 249, 250);&quot;&gt;已接入 hudi&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-199" vertex="1" connectable="0">
          <mxGeometry x="-0.3333" y="1" relative="1" as="geometry">
            <mxPoint x="-3" y="58" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-201" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-203" target="rjfQ9kvNoMq7JbhmC_GC-208" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="158.5" y="-311" as="sourcePoint" />
            <mxPoint x="275.5" y="-266" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-202" value="新表/&lt;br&gt;已接入kafka" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-201" vertex="1" connectable="0">
          <mxGeometry x="-0.2774" y="-1" relative="1" as="geometry">
            <mxPoint x="43" y="-4" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-203" value="表接入状&lt;br&gt;况判断" style="rhombus;whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="52.5" y="-615" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-204" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-205" target="rjfQ9kvNoMq7JbhmC_GC-208" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-205" value="停止 hudi 写入任务且清理旧数据" style="whiteSpace=wrap;html=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="38" y="-397" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-206" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.629;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" target="rjfQ9kvNoMq7JbhmC_GC-210" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="289.5" y="-458" as="sourcePoint" />
            <mxPoint x="287.52" y="-416.98" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-213" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-208" target="rjfQ9kvNoMq7JbhmC_GC-212" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-214" value="生成运行一次的调度任务&lt;br&gt;并调度id记录在直通车" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-213" vertex="1" connectable="0">
          <mxGeometry x="-0.1473" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-208" value="生成hive同步调度任务" style="rounded=1;whiteSpace=wrap;html=1;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="190" y="-517" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-209" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=30;exitDy=0;exitPerimeter=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-210" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="276.5" y="-458" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-210" value="调度脚本生成工具" style="shape=cube;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;darkOpacity=0.05;darkOpacity2=0.1;size=10;" parent="1" vertex="1">
          <mxGeometry x="246.5" y="-407" width="70" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-212" value="调度" style="rounded=1;whiteSpace=wrap;html=1;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="614" y="-518" width="96" height="58" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-234" value="hdfs&lt;br&gt;xxx/.hoodie" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="1090" y="-615" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-235" value="HMS" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="950" y="-710" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-242" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-238" target="rjfQ9kvNoMq7JbhmC_GC-234" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-243" value="hdfs merge" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-242" vertex="1" connectable="0">
          <mxGeometry x="-0.1252" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-244" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startSize=1;endSize=6;targetPerimeterSpacing=0;startArrow=none;" parent="1" target="rjfQ9kvNoMq7JbhmC_GC-15" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="760" y="-640" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-238" value="flink cdc" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="850" y="-615" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-246" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-145" target="rjfQ9kvNoMq7JbhmC_GC-145" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-254" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.sequential_data;whiteSpace=wrap;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="760" y="-655" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-255" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;startSize=1;endSize=6;sourcePerimeterSpacing=0;endArrow=none;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-238" target="rjfQ9kvNoMq7JbhmC_GC-254" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="861.7157287525379" y="-603.2842712474621" as="sourcePoint" />
            <mxPoint x="700" y="-670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-256" value="元数据变更同步" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjfQ9kvNoMq7JbhmC_GC-255" vertex="1" connectable="0">
          <mxGeometry x="-0.1125" relative="1" as="geometry">
            <mxPoint x="-39" y="-15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-257" value="" style="endArrow=none;dashed=1;html=1;rounded=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="10" y="-120" as="sourcePoint" />
            <mxPoint x="820" y="-120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-295" value="&lt;span style=&quot;background-color: rgb(248, 249, 250);&quot;&gt;RO &amp;amp; RT&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;" parent="rjfQ9kvNoMq7JbhmC_GC-257" vertex="1" connectable="0">
          <mxGeometry x="-0.0247" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-258" value="HoodieParquetInputFormatBase" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
          <mxGeometry x="30" y="220" width="270" height="90" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-259" value="Use" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;fontColor=default;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" parent="rjfQ9kvNoMq7JbhmC_GC-258" target="rjfQ9kvNoMq7JbhmC_GC-281" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="270" y="40" as="sourcePoint" />
            <mxPoint x="430" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-260" value="+ HoodieTableInputFormat inputFormatDelegate &#xa;+getSplits&#xa;+ listStatus" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-258" vertex="1">
          <mxGeometry y="26" width="270" height="64" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-261" value="MapredParquetInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
          <mxGeometry x="30" y="70" width="255.5" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-262" value="+ getSplits&#xa;+ listStatus&#xa;+getRecordReader" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-261" vertex="1">
          <mxGeometry y="26" width="255.5" height="54" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-263" value="FileInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
          <mxGeometry x="34.5" y="-70" width="260" height="90" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-264" value="+ getSplits" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-263" vertex="1">
          <mxGeometry y="26" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-265" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-263" vertex="1">
          <mxGeometry y="52" width="260" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-266" value="+ listStatus" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-263" vertex="1">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-267" value="HoodieInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="10" y="498" width="130" height="62" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-268" value="HoodieParquetInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=#CCFF99;" parent="1" vertex="1">
          <mxGeometry x="30" y="370" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-269" value="+getRecordReader" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-268" vertex="1">
          <mxGeometry y="26" width="260" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-270" value="HoodieParquetRealtimeInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=#CCFF99;" parent="1" vertex="1">
          <mxGeometry x="168" y="498" width="230" height="58" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-271" value="getRecordReader" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-270" vertex="1">
          <mxGeometry y="26" width="230" height="24" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-272" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="rjfQ9kvNoMq7JbhmC_GC-270" vertex="1">
          <mxGeometry y="50" width="230" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-273" value="HoodieRealtimeInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
          <mxGeometry x="198" y="600" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-274" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.469;entryY=1.154;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-261" target="rjfQ9kvNoMq7JbhmC_GC-266" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="170" y="20" as="sourcePoint" />
            <mxPoint x="140" y="20" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-275" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.513;entryY=1.037;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-258" target="rjfQ9kvNoMq7JbhmC_GC-262" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="495" y="70" as="sourcePoint" />
            <mxPoint x="570" y="13" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-276" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1.016;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-268" target="rjfQ9kvNoMq7JbhmC_GC-260" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="345" y="190" as="sourcePoint" />
            <mxPoint x="480.1199999999999" y="161.024" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-277" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.492;entryY=1.042;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-267" target="rjfQ9kvNoMq7JbhmC_GC-269" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="115" y="388" as="sourcePoint" />
            <mxPoint x="200.07999999999993" y="430" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-278" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.512;entryY=1.125;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-270" target="rjfQ9kvNoMq7JbhmC_GC-269" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="105" y="508" as="sourcePoint" />
            <mxPoint x="226" y="430.98799999999983" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-279" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-273" target="rjfQ9kvNoMq7JbhmC_GC-272" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="445" y="518" as="sourcePoint" />
            <mxPoint x="236" y="440.98800000000006" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-280" value="&lt;div&gt;test_hudi_table5_rt&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; WITH SERDEPROPERTIES (&#39;hoodie.query.as.ro.table&#39;=&#39;false&#39;)&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; STORED AS INPUTFORMAT&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&#39;org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;test_hudi_table5_ro&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; WITH SERDEPROPERTIES (&#39;hoodie.query.as.ro.table&#39;=&#39;true&#39;)&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; STORED AS INPUTFORMAT&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt; &lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&#39;org.apache.hudi.hadoop.HoodieParquetInputFormat&#39;&amp;nbsp;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;labelBorderColor=default;" parent="1" vertex="1">
          <mxGeometry x="419.5" y="470" width="420" height="140" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-281" value="abstract HoodieTableInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=default;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="419.5" y="70" width="250" height="86" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-282" value="+ Configuration conf" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;labelBackgroundColor=default;fontColor=default;" parent="rjfQ9kvNoMq7JbhmC_GC-281" vertex="1">
          <mxGeometry y="26" width="250" height="26" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-283" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;labelBackgroundColor=#CCFF99;fontColor=#99FF99;" parent="rjfQ9kvNoMq7JbhmC_GC-281" vertex="1">
          <mxGeometry y="52" width="250" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-284" value="+ listStatus(super.listStatus(job))" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;labelBackgroundColor=default;fontColor=default;" parent="rjfQ9kvNoMq7JbhmC_GC-281" vertex="1">
          <mxGeometry y="60" width="250" height="26" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-285" value="HoodieCopyOnWriteTableInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=default;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="420" y="227" width="243" height="76" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-286" value="+ listStatus&#xa;+listStatusForIncrementalMode&#xa;+listStatusForSnapshotMode" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;labelBackgroundColor=default;fontColor=default;" parent="rjfQ9kvNoMq7JbhmC_GC-285" vertex="1">
          <mxGeometry y="26" width="243" height="50" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-287" value="HoodieMergeOnReadTableInputFormat" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;labelBackgroundColor=default;fontColor=default;" parent="1" vertex="1">
          <mxGeometry x="402.5" y="350" width="267" height="70" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-288" value="+ getSplits&#xa;+listStatusForIncrementalMode" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;labelBackgroundColor=default;fontColor=default;" parent="rjfQ9kvNoMq7JbhmC_GC-287" vertex="1">
          <mxGeometry y="26" width="267" height="44" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-289" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-281" target="rjfQ9kvNoMq7JbhmC_GC-266" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="495" y="70" as="sourcePoint" />
            <mxPoint x="570" y="13" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-290" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.472;entryY=0.962;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-285" target="rjfQ9kvNoMq7JbhmC_GC-284" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="872" y="90" as="sourcePoint" />
            <mxPoint x="607" y="33" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-291" value="Extends" style="endArrow=block;endSize=16;endFill=0;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.481;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="rjfQ9kvNoMq7JbhmC_GC-287" target="rjfQ9kvNoMq7JbhmC_GC-286" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="866.5" y="290" as="sourcePoint" />
            <mxPoint x="865" y="175.01199999999994" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-293" value="" style="endArrow=none;dashed=1;html=1;rounded=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="836" y="-120" as="sourcePoint" />
            <mxPoint x="1646" y="-120" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-294" value="历史数据同步" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;" parent="rjfQ9kvNoMq7JbhmC_GC-293" vertex="1" connectable="0">
          <mxGeometry x="0.0593" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-303" value="" style="endArrow=none;html=1;rounded=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="910" y="13" as="sourcePoint" />
            <mxPoint x="1500" y="13" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-304" value="" style="line;strokeWidth=2;direction=south;html=1;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1040" y="-31" width="10" height="124" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-306" value="" style="line;strokeWidth=2;direction=south;html=1;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1175" y="-31" width="10" height="124" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-307" value="" style="line;strokeWidth=2;direction=south;html=1;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1260" y="-31" width="10" height="124" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-313" value="binlog" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1320" y="-52" width="80" height="19" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-315" value="" style="line;strokeWidth=2;direction=south;html=1;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="910" y="-31" width="10" height="124" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-316" value="20200101" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="890" y="93" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-317" value="20200401" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1010" y="93" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-318" value="20200601" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1150" y="93" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-319" value="20200602" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1235" y="93" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-321" value="&lt;span style=&quot;background-color: rgb(153, 255, 153);&quot;&gt;HIVE&lt;/span&gt;" style="shape=crossbar;whiteSpace=wrap;html=1;rounded=1;labelBorderColor=none;fontSize=15;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="915" y="-45" width="265" height="18" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-324" value="&lt;span style=&quot;background-color: rgb(153, 255, 153);&quot;&gt;MYSQL&lt;/span&gt;" style="shape=crossbar;whiteSpace=wrap;html=1;rounded=1;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="1045" y="-70" width="221" height="23" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-327" value="" style="endArrow=classic;html=1;rounded=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1400" y="13" as="sourcePoint" />
            <mxPoint x="1510" y="13" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-329" value="&lt;span style=&quot;&quot;&gt;假定 mysql&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [20200401,&amp;nbsp; 20200403] 数据分区不变更&lt;br&gt;hive 存量同步到 [20200101, 20200403] 的数据&lt;br&gt;myql 同步&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;[20200401,&amp;nbsp;&lt;/span&gt;+∞)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 的数据&lt;span style=&quot;&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="text;strokeColor=none;fillColor=none;html=1;fontSize=24;fontStyle=1;verticalAlign=middle;align=left;rounded=1;labelBackgroundColor=#FFFFFF;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="890" y="156" width="640" height="110" as="geometry" />
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-330" value="" style="endArrow=none;dashed=1;html=1;rounded=0;fontSize=15;startSize=1;endSize=6;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="836" y="350" as="sourcePoint" />
            <mxPoint x="1646" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-331" value="版本的清理" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;" parent="rjfQ9kvNoMq7JbhmC_GC-330" vertex="1" connectable="0">
          <mxGeometry x="0.0593" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rjfQ9kvNoMq7JbhmC_GC-333" value="&lt;div&gt;背景： 为了做 ods 层的增量视图&lt;/div&gt;&lt;div&gt;1、所谓一天一个 版本 应该是 一天一个 savepoint&lt;br&gt;2、能否根据 savepoint 做增量&lt;br&gt;3、原生 start/end commit 区间查询逻辑梳理&lt;/div&gt;&lt;div&gt;4、对于没有变更的数据&amp;nbsp;_hoodie_commit_time 是否会变化&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;html=1;fontSize=24;fontStyle=1;verticalAlign=middle;align=left;rounded=1;labelBackgroundColor=#FFFFFF;labelBorderColor=none;" parent="1" vertex="1">
          <mxGeometry x="880" y="390" width="590" height="130" as="geometry" />
        </mxCell>
        <mxCell id="Xd3tCwa5FzFZhnE2AB4F-1" value="HIVE 同步工具对接资产&lt;br&gt;Spark&amp;nbsp; mr 查询适配 无 RO/RT 场景" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="376.5" y="-94" width="210" height="42" as="geometry" />
        </mxCell>
        <mxCell id="fn1M0nBAdgjgUEnhOP8Y-1" value="org.apache.hudi.sink.StreamWriteOperatorCoordinator&lt;br&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;start -&amp;gt; initHiveSync&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;br&gt;&lt;/span&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;close -&amp;gt; hiveSyncExecutor&lt;span style=&quot;font-size: 9pt;&quot;&gt;.close&lt;/span&gt;&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;notifyCheckpointComplete -&amp;gt; syncHiveAsync&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;handleEndInputEvent -&amp;gt; syncHive&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;syncHiveAsync()-&amp;gt; hiveSyncExecutor：doSyncHive&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;syncHive-&amp;gt; doSyncHive&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 9pt;&quot;&gt;&lt;span style=&quot;font-size: 9pt;&quot;&gt;doSyncHive&lt;/span&gt;&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;() -&amp;gt; &lt;/span&gt;hiveSyncContext&lt;span style=&quot;font-size: 9pt;&quot;&gt;.hiveSyncTool&lt;/span&gt;&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;span style=&quot;font-size: 9pt;&quot;&gt;.syncHoodieTable&lt;/span&gt;&lt;span style=&quot;font-size: 9pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;&quot;&gt;()&lt;/span&gt;&lt;/pre&gt;&lt;/pre&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="25" y="700" width="478" height="300" as="geometry" />
        </mxCell>
        <mxCell id="fn1M0nBAdgjgUEnhOP8Y-2" value="1、schema 变更同步方案&lt;br&gt;&amp;nbsp; &amp;nbsp; 1.1、cdc ddl 时会给资产发 schema, 资产可以将 schema 转化成 hive 的 字段和类型，和hive 原有进行比对执行字段增删改&lt;br&gt;&amp;nbsp; &amp;nbsp; 1.2、每次 hudi commit 时返回 hive 应有的字段和类型给资产, 资产经过比对进行字段增删改&lt;br&gt;&amp;nbsp; &amp;nbsp; 1.3、每次 hudi commit 时调用资产接口返回hive 表结构，经过比对之后形成 alter 语句给资产&amp;nbsp;&lt;br&gt;&lt;br&gt;2、分区同步方案&lt;br&gt;&amp;nbsp; &amp;nbsp; 2.1、通过资产获取上一次同步的 commit 位置，增量获取分区形成 alter 给资产&lt;br&gt;&amp;nbsp; &amp;nbsp; 2.2、获取全部分区形成 alter 给资产&lt;br&gt;&amp;nbsp; &amp;nbsp; 2.3、每次 hudi commit 时给资产发送 分区修复命令。msck repair table xx&lt;br&gt;&lt;br&gt;3、注释信息同步&lt;br&gt;&amp;nbsp; &amp;nbsp; 3.1、注释信息不同步，因为在 ddl 时 已经给资产发送了最新注释&amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;labelBorderColor=none;fontSize=15;" parent="1" vertex="1">
          <mxGeometry x="880" y="-526.62" width="530" height="319.25" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="N7DTVl0QF5ZTBbWYrLca" name="hive-ods-hudi-ods">
    <mxGraphModel dx="1398" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-1" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" vertex="1" parent="1">
          <mxGeometry x="110" y="560" width="540" height="205" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-1">
          <mxGeometry width="540" height="41" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-3" value="原有方式" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-4" value="hudi 化方式" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry x="90" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-5" value="计算引擎" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry x="180" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-6" value="hudi分区" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry x="270" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-7" value="对比原有" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry x="360" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-8" value="其他" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-2">
          <mxGeometry x="450" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-9" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-1">
          <mxGeometry y="41" width="540" height="41" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-10" value="离线 datax" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-11" value="离线 增量入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry x="90" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-12" value="spark" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry x="180" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-13" value="系统时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry x="270" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-14" value="没有啥意义" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry x="360" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-15" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-9">
          <mxGeometry x="450" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-16" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-1">
          <mxGeometry y="82" width="540" height="41" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-17" value="离线 datax" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-18" value="离线 增量入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry x="90" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-19" value="spark" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry x="180" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-20" value="业务时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry x="270" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-21" value="全局去重" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry x="360" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-22" value="跨分区更新不支持" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-16">
          <mxGeometry x="450" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-23" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-1">
          <mxGeometry y="123" width="540" height="41" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-24" value="离线 datax" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-25" value="cdc 入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry x="90" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-26" value="flink" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry x="180" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-27" value="业务时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry x="270" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-28" value="去重&amp;amp;时效提升" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry x="360" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-29" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-23">
          <mxGeometry x="450" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-30" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-1">
          <mxGeometry y="164" width="540" height="41" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-31" value="flink drag" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-32" value="flink hudi 入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry x="90" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-33" value="flink" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry x="180" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-34" value="系统时间/kafka时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry x="270" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-35" value="分区去重" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry x="360" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-36" value="跨分区更新不支持" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-30">
          <mxGeometry x="450" width="90" height="41" as="geometry">
            <mxRectangle width="90" height="41" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-37" value="离线 dataX" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;imageWidth=38;imageHeight=2;" vertex="1" parent="1">
          <mxGeometry x="110" y="600" width="90" height="124" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-38" value="spark" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="290" y="600" width="90" height="84" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-39" value="离线增量入湖" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="200" y="600" width="90" height="84" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-40" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-43" target="o3F5QTeAZ5qrzgeEGrW9-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-41" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-43" target="o3F5QTeAZ5qrzgeEGrW9-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-42" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-43" target="o3F5QTeAZ5qrzgeEGrW9-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-43" value="ods(hive)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="135" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-44" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-51">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="104" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-45" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-52">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="104" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-46" value="全量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="74" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-47" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-48" target="o3F5QTeAZ5qrzgeEGrW9-53">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-48" value="增量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="144" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-49" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-50" target="o3F5QTeAZ5qrzgeEGrW9-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-50" value="流水表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B3B3B3;" vertex="1" parent="1">
          <mxGeometry x="160" y="214" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-51" value="分区表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="320" y="30" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-52" value="不分区" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="320" y="90" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-53" value="分区表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="320" y="152" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-54" value="分区表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B3B3B3;" vertex="1" parent="1">
          <mxGeometry x="320" y="222" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-55" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="175" as="sourcePoint" />
            <mxPoint x="160" y="104" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-56" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-57">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="175" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-57" value="增量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="144" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-58" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="175" as="sourcePoint" />
            <mxPoint x="160" y="104" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-59" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-60">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="175" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-60" value="增量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="144" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-61" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-62" target="o3F5QTeAZ5qrzgeEGrW9-64">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-62" value="ods(hive)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="401" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-63" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-65">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="280" y="370" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-64" value="全量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="340" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-65" value="不分区" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="320" y="348" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-66" value="分区表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="320" y="476" width="100" height="44" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-67" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="441" as="sourcePoint" />
            <mxPoint x="160" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-68" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="441" as="sourcePoint" />
            <mxPoint x="160" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-69" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="o3F5QTeAZ5qrzgeEGrW9-71">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="441" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="o3F5QTeAZ5qrzgeEGrW9-71" target="o3F5QTeAZ5qrzgeEGrW9-66">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-71" value="增量表" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="160" y="468" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-72" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="293" y="278" as="sourcePoint" />
            <mxPoint x="293" y="333" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-73" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="310" y="1170" as="sourcePoint" />
            <mxPoint x="310" y="1240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-74" value="视图如何实现" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="o3F5QTeAZ5qrzgeEGrW9-73">
          <mxGeometry x="-0.5429" y="-1" relative="1" as="geometry">
            <mxPoint y="14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-75" value="&lt;div class=&quot;mind-clipboard&quot;&gt;全量分区：&lt;div&gt;&amp;nbsp; &amp;nbsp;1、原来使用方式 select&amp;nbsp; from t where inc_day= T-1 拿全量&lt;br&gt;&amp;nbsp; &amp;nbsp;2、创建分区视图&lt;span style=&quot;font-size: inherit;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;每日增量：&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;1、原来使用方式 select&amp;nbsp; from t where inc_day= T-1 拿增量&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;2、hudi 需要实现 t-1 日增量视图&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;create view partition on (inc_day) as select&amp;nbsp; *，t-1 as inc_day from hudi where commit between t-2 and t-1&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="110" y="1240" width="450" height="170" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-76" value="&lt;div class=&quot;mind-clipboard&quot;&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp;分区视图示例：&lt;/b&gt;&lt;/div&gt;&amp;nbsp;CREATE VIEW log_view PARTITIONED ON (pagename,year,month,day) AS SELECTuid,properties,pagename year,month,day FROM log;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="610" y="1270" width="440" height="50" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-77" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="310" y="1400" as="sourcePoint" />
            <mxPoint x="310" y="1470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-78" value="无感切换" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="o3F5QTeAZ5qrzgeEGrW9-77">
          <mxGeometry x="-0.5429" y="-1" relative="1" as="geometry">
            <mxPoint y="14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-79" value="&lt;div class=&quot;mind-clipboard&quot;&gt;hive 表与 hudi 表之间的切换 同运单宽表切换&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;hive 表与 视图的切换，只需要表名置换出来就行&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="177.5" y="1480" width="315" height="60" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-80" value="&lt;div class=&quot;mind-clipboard&quot;&gt;&lt;b&gt;无感切换示例&lt;/b&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; 1、创建一个 hudi 表 lj.overwrite&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; location&amp;nbsp;&amp;nbsp;hdfs://1a41vla2748hadp:8020/user/hive/warehouse/lj.db/overwrite&#39;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2、创建一个 hive 表 lj.overwrite_out&amp;nbsp; &amp;nbsp; &amp;nbsp; location&amp;nbsp;&amp;nbsp;hdfs://1a41vla2748hadp:8020/user/hive/warehouse/lj.db/overwrite2&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;hive 表切 hudi 表切&lt;/b&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;切路径：&amp;nbsp; &amp;nbsp; &amp;nbsp;alter table lj.overwrite_out set location &#39;hdfs://1a41vla2748hadp:8020/user/hive/warehouse/lj.db/overwrite&#39;;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;修改format: ALTER TABLE lj.overwrite_out SET FILEFORMAT &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; INPUTFORMAT &#39;org.apache.hudi.hadoop.HoodieParquetInputFormat&#39; &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; OUTPUTFORMAT &#39;org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat&#39; &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; SERDE &#39;org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe&#39; ;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;删除分区： alter table lj.overwrite_out drop partition (dt!= &#39;&#39;);&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;修复分区： MSCK REPAIR TABLE lj.overwrite_out;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;修改table 属性： alter table lj.overwrite_out SET TBLPROPERTIES(&#39;spark.sql.sources.provider&#39;=&#39;hudi&#39;);&lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; alter table lj.overwrite_out SET SERDEPROPERTIES (&#39;path&#39;=&#39;hdfs://1a41vla2748hadp:8020/user/hive/warehouse/lj.db/overwrite&#39;);&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;b&gt;hudi 表切回 hive&lt;/b&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;切路径：&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; alter table lj.overwrite_out set location &#39;hdfs://1a41vla2748hadp:8020/user/hive/warehouse/lj.db/overwrite2&#39;;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;修改format:ALTER TABLE lj.overwrite_out SET FILEFORMAT &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;INPUTFORMAT &#39;org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat&#39; &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; OUTPUTFORMAT &#39;org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat&#39; &lt;div&gt;&lt;/div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; SERDE &#39;org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe&#39; ;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;删除分区： alter table lj.overwrite_out drop partition (dt!= &#39;&#39;);&lt;/div&gt;&lt;div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;修复分区： MSCK REPAIR TABLE lj.overwrite_out;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;恢复属性： alter table lj.overwrite_out UNSET TBLPROPERTIES(&#39;spark.sql.sources.provider&#39;=&#39;hudi&#39;);&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="600" y="1360" width="670" height="420" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-81" value="" style="shape=table;html=1;whiteSpace=wrap;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fillColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="123" y="802" width="430" height="288" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-82" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-81">
          <mxGeometry width="430" height="118" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-83" value="" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-82">
          <mxGeometry width="100" height="118" as="geometry">
            <mxRectangle width="100" height="118" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-84" value="全量表不分区" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-82">
          <mxGeometry x="100" width="115" height="118" as="geometry">
            <mxRectangle width="115" height="118" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-85" value="全量表分区" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-82">
          <mxGeometry x="215" width="108" height="118" as="geometry">
            <mxRectangle width="108" height="118" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-86" value="增量表" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-82">
          <mxGeometry x="323" width="107" height="118" as="geometry">
            <mxRectangle width="107" height="118" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-87" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-81">
          <mxGeometry y="118" width="430" height="50" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-88" value="离线增量入湖&lt;br&gt;系统时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-87">
          <mxGeometry width="100" height="50" as="geometry">
            <mxRectangle width="100" height="50" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-89" value="否" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-87">
          <mxGeometry x="100" width="115" height="50" as="geometry">
            <mxRectangle width="115" height="50" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-90" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-87">
          <mxGeometry x="215" width="108" height="50" as="geometry">
            <mxRectangle width="108" height="50" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-91" value="否" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-87">
          <mxGeometry x="323" width="107" height="50" as="geometry">
            <mxRectangle width="107" height="50" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-92" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-81">
          <mxGeometry y="168" width="430" height="40" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-93" value="离线增量入湖&lt;br&gt;业务时间" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-92">
          <mxGeometry width="100" height="40" as="geometry">
            <mxRectangle width="100" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-94" value="否" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-92">
          <mxGeometry x="100" width="115" height="40" as="geometry">
            <mxRectangle width="115" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-95" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-92">
          <mxGeometry x="215" width="108" height="40" as="geometry">
            <mxRectangle width="108" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-96" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-92">
          <mxGeometry x="323" width="107" height="40" as="geometry">
            <mxRectangle width="107" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-97" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-81">
          <mxGeometry y="208" width="430" height="40" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-98" value="cdc 入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-97">
          <mxGeometry width="100" height="40" as="geometry">
            <mxRectangle width="100" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-99" value="否" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-97">
          <mxGeometry x="100" width="115" height="40" as="geometry">
            <mxRectangle width="115" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-100" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-97">
          <mxGeometry x="215" width="108" height="40" as="geometry">
            <mxRectangle width="108" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-101" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-97">
          <mxGeometry x="323" width="107" height="40" as="geometry">
            <mxRectangle width="107" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-102" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-81">
          <mxGeometry y="248" width="430" height="40" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-103" value="flink hudi 入湖" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-102">
          <mxGeometry width="100" height="40" as="geometry">
            <mxRectangle width="100" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-104" value="×" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-102">
          <mxGeometry x="100" width="115" height="40" as="geometry">
            <mxRectangle width="115" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-105" value="×" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-102">
          <mxGeometry x="215" width="108" height="40" as="geometry">
            <mxRectangle width="108" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-106" value="需要" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;pointerEvents=1;" vertex="1" parent="o3F5QTeAZ5qrzgeEGrW9-102">
          <mxGeometry x="323" width="107" height="40" as="geometry">
            <mxRectangle width="107" height="40" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-107" value="" style="endArrow=none;html=1;rounded=0;entryX=0.133;entryY=-0.016;entryDx=0;entryDy=0;entryPerimeter=0;startArrow=none;" edge="1" parent="o3F5QTeAZ5qrzgeEGrW9-81" target="o3F5QTeAZ5qrzgeEGrW9-87">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="-2" as="sourcePoint" />
            <mxPoint x="470" y="38" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-108" value="" style="endArrow=none;html=1;rounded=0;startArrow=none;" edge="1" parent="o3F5QTeAZ5qrzgeEGrW9-81" target="o3F5QTeAZ5qrzgeEGrW9-82">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="8" as="sourcePoint" />
            <mxPoint x="67.19000000000005" y="126.01600000000008" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-109" value="表类型" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="177" y="814" width="40" height="20" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-110" value="hudi 化&lt;br&gt;方式" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="120" y="885" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-111" value="" style="endArrow=none;html=1;rounded=0;startArrow=none;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="123" y="802" as="sourcePoint" />
            <mxPoint x="219" y="863" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-112" value="是否需要视图" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="167" y="860" width="43" height="20" as="geometry" />
        </mxCell>
        <mxCell id="o3F5QTeAZ5qrzgeEGrW9-113" value="hudi 化方式&lt;br&gt;&amp;nbsp; &amp;nbsp; 离线增量入湖&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;全量表： 初始化拉取一天的数据导入 hudi; jdbc拉取增量 merge 入 hudi&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 增量表： 将 hive 数据按批次从老到新依次 merge 初始化，之后 jdbc 拉取增量 merge 入 hudi&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; cdc 入湖：&amp;nbsp;将 hive 数据按批次从老到新依次 merge 初始化，之后 cdc 同步 mysql 存量+ binlog 入湖&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; flink drag：新建任务消费 kafka 入hudi,当需要替换时，创建视图，老的分区指向老的hive 表，新的分区指向 hudi 表&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBorderColor=default;" vertex="1" parent="1">
          <mxGeometry x="650" y="820" width="340" height="130" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
